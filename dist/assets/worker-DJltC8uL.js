(function(){"use strict";const B=["ğŸ˜€","ğŸ˜ƒ","ğŸ˜„","ğŸ˜","ğŸ˜†","ğŸ˜…","ğŸ¤£","ğŸ˜‚","ğŸ™‚","ğŸ™ƒ","ğŸ˜‰","ğŸ˜Š","ğŸ˜‡","ğŸ¥°","ğŸ˜","ğŸ¤©","ğŸ˜˜","ğŸ˜—","â˜ºï¸","ğŸ˜š","ğŸ˜™","ğŸ¥²","ğŸ˜‹","ğŸ˜›","ğŸ˜œ","ğŸ¤ª","ğŸ˜","ğŸ¤‘","ğŸ¤—","ğŸ¤­","ğŸ¤«","ğŸ¤”","ğŸ¤","Kb","ğŸ˜","ğŸ˜‘","ğŸ˜¶","ğŸ˜","ğŸ˜’","ğŸ™„","ğŸ˜¬","ğŸ¤¥","ğŸ˜Œ","zk","ğŸ˜´","ğŸ¤¤","ğŸ˜ª","ğŸ˜·","ğŸ¤’","ğŸ¤•","ğŸ¤¢","ğŸ¤®","ğŸ¤§","ğŸ¥µ","ğŸ¥¶","ğŸ¥´","ğŸ˜µ","ğŸ¤¯","ğŸ¤ ","ğŸ¥³","ğŸ˜","ğŸ¤“","ğŸ§","ğŸ˜•","ğŸ˜Ÿ","ğŸ™","â˜¹ï¸","ğŸ˜®","ğŸ˜¯","ğŸ˜²","ğŸ˜³","ğŸ¥º","ğŸ˜¦","ğŸ˜§","ğŸ˜¨","ğŸ˜°","ğŸ˜¥","ğŸ˜¢","ğŸ˜­","ğŸ˜±","ğŸ˜–","ğŸ˜£","ğŸ˜","ğŸ˜“","ğŸ˜©","ğŸ˜«","ğŸ¥±","ğŸ˜¤","ğŸ˜¡","ğŸ˜ ","ğŸ¤¬","ğŸ˜ˆ","ğŸ‘¿","ğŸ’€","â˜ ï¸","ğŸ’©","ğŸ¤¡","ğŸ‘¹","ğŸ‘º","ğŸ‘»","ğŸ‘½","ğŸ‘¾","ğŸ¤–","â¤ï¸","ğŸ§¡","ğŸ’›","ğŸ’š","ğŸ’™","ğŸ’œ","ğŸ–¤","ğŸ¤","ğŸ¤","ğŸ’”","â£ï¸","ğŸ’•","ğŸ’","ğŸ’“","ğŸ’—","ğŸ’–","ğŸ’˜","ğŸ’","ğŸ‘","ğŸ‘","ğŸ‘Š","âœŠ","ğŸ¤›","ğŸ¤œ","ğŸ¤","âœŒï¸","ğŸ¤Ÿ","ğŸ¤˜","ğŸ‘Œ","ğŸ¤","ğŸ‘ˆ","ğŸ‘‰","ğŸ‘†","ğŸ‘‡","â˜ï¸","âœ‹","ğŸ¤š","ğŸ–","ğŸ––","ğŸ‘‹","ğŸ¤™","ğŸ’ª","ğŸ¦µ","ğŸ¦¶","ğŸ™","ğŸ¤","ğŸ¶","ğŸ±","ğŸ­","ğŸ¹","ğŸ°","ğŸ¦Š","ğŸ»","ğŸ¼","ğŸ¨","ğŸ¯","ğŸ¦","Dg","ğŸ®","ğŸ·","ğŸ½","ğŸ¸","ğŸµ","ğŸ™ˆ","ğŸ™‰","ğŸ™Š","ğŸ’","ğŸ”","ğŸ§","ğŸ¦","ğŸ¤","ğŸ£","l","ğŸ¦†","ğŸ¦…","ğŸ¦‰","bat","wolf","boar","horse","unicorn","bee","bug","butterfly","snail","beetle","ant","mosquito","cricket","spider","web","turtle","snake","lizard","rex","sauropod","octopus","squid","shrimp","lobster","crab","puffer","shark","fish","tropical","whale","dolphin","ğŸŒ²","ğŸŒ³","ğŸŒ´","ğŸŒµ","ğŸŒ¾","ğŸŒ¿","â˜˜ï¸","ğŸ€","ğŸ","ğŸ‚","ğŸƒ","ğŸ„","ğŸŒ°","ğŸ’","ğŸŒ·","ğŸŒ¹","ğŸ¥€","ğŸŒº","ğŸŒ¸","ğŸŒ¼","ğŸŒ»","ğŸŒ","ğŸŒ","ğŸŒ›","ğŸŒœ","ğŸŒš","ğŸŒ•","ğŸŒ–","ğŸŒ—","ğŸŒ˜","ğŸŒ‘","ğŸŒ’","ğŸŒ“","ğŸŒ”","ğŸŒ™","ğŸŒ","ğŸŒ","ğŸŒ","ğŸª","ğŸ’«","â­ï¸","ğŸŒŸ","âœ¨","âš¡ï¸","â˜„ï¸","ğŸ’¥","ğŸ”¥","ğŸŒª","ğŸŒˆ","â˜€ï¸","â˜ï¸","â›…ï¸","â›ˆ","ğŸŒ©","ğŸŒ¨","â„ï¸","â˜ƒï¸","â›„ï¸","ğŸŒ¬","ğŸ’¨","ğŸ’§","ğŸ’¦","â˜”ï¸","â˜‚ï¸","ğŸŒŠ","ğŸ","ğŸ","ğŸ","ğŸŠ","ğŸ‹","ğŸŒ","ğŸ‰","ğŸ‡","ğŸ“","ğŸˆ","ğŸ’","ğŸ‘","ğŸ¥­","ğŸ","ğŸ¥¥","ğŸ¥","ğŸ…","ğŸ†","ğŸ¥‘","ğŸ¥¦","ğŸ¥¬","ğŸ¥’","ğŸŒ¶","ğŸŒ½","ğŸ¥•","garlic","onion","potato","yam","croissant","bagel","bread","baguette","pretzel","cheese","egg","bacon","steak","pancake","waffle","burger","fries","pizza","hotdog","sandwich","taco","burrito","stuffed","falafel","curry","sushi","bento","dumpling","shrimp_fried","rice","rice_ball","cracker","oden","dango","shaved_ice","ice_cream","shortcake","cupcake","pie","chocolate","candy","lollipop","custard","honey","milk","tea","sake","champagne","wine","beer","cheers","tumbler","cup","juice","mate","âš½ï¸","ğŸ€","ğŸˆ","âš¾ï¸","softball","tennis","volleyball","rugby","frisbee","ping_pong","badminton","goal","hockey","field_hockey","lacrosse","cricket_bat","boxing","martial_arts","skating","skiing","snowboarding","skateboarding","running","climbing","golf","archery","fishing","diving","rowing","swimming","surfs","pool","weight","cycle","mtb","gymnastics","wrestling","water_polo","handball","juggling","yoga","meditation","lamp","notebook","book","money","envelope","package","postbox","pencil","pen","brush","crayon","ruler","ğŸ”´","ğŸŸ ","ğŸŸ¡","ğŸŸ¢","ğŸ”µ","ğŸŸ£","âš«ï¸","âšªï¸","ğŸŸ¤","ğŸŸ¥","ğŸŸ§","ğŸŸ¨","ğŸŸ©","ğŸŸ¦","ğŸŸª","â¬›ï¸","â¬œï¸","ğŸŸ«"];function O(e,s){return(e.r-s.r)**2+(e.g-s.g)**2+(e.b-s.b)**2}let f=[],R=!1,j=!1;async function G(){if(R)return;const e=32,t=new OffscreenCanvas(e,e).getContext("2d");if(!t)return;t.font=`${e}px sans-serif`,t.textBaseline="middle",t.textAlign="center";const g=[];for(const b of B){t.clearRect(0,0,e,e),t.fillText(b,e/2,e/2+2);const c=t.getImageData(0,0,e,e).data;let S=0,p=0,k=0,l=0;for(let i=0;i<c.length;i+=4)c[i+3]>128&&(S+=c[i],p+=c[i+1],k+=c[i+2],l++);l>0&&g.push({char:b,r:Math.round(S/l),g:Math.round(p/l),b:Math.round(k/l)})}f=g,R=!0,self.postMessage({type:"INIT_COMPLETE",count:f.length})}async function U(e,s,t,g,b){if(!R||f.length===0){self.postMessage({type:"ERROR",message:"Worker not initialized"});return}j=!1;const{density:D,platformWidth:c,quality:S}=g,p=g.platform||"standard",k=g.deviceMode||"mobile",l=b==="dot",i=b==="text";let m=40;if(b==="image")m=Math.max(1,Math.floor(s/(D||10)));else if(i){const n=c||40;m=k==="mobile"?n:Math.floor(n*2.2)}else l&&(m=c?k==="mobile"?c:Math.floor(c*2.2):k==="mobile"?40:80);const X=t/s,_=Math.floor(m*X*.55),L=s/m,P=t/_,z=[];let N="";const F=_*m;let W=0;const v=S==="performance"?1:2,H=4;for(let n=0;n<_;n++){if(j){self.postMessage({type:"CANCELLED"});return}let d="";const w=n*P;for(let y=0;y<m;y++){const I=y*L;let $=0,q=0,A=0,E=0;const K=L/v,Y=P/v;for(let u=0;u<v;u++){const M=Math.floor(w+u*Y);if(M>=t)continue;const x=M*s;for(let T=0;T<v;T++){const r=Math.floor(I+T*K);if(r>=s)continue;const o=(x+r)*4;$+=e[o],q+=e[o+1],A+=e[o+2],E++}}if(E>0){const u=$/E,M=q/E,x=A/E,T=u*.299+M*.587+x*.114;if(l){const r=g.renderingType||"ascii";let o=" .:-=+*#%@";r==="unicode"?o=p==="whatsapp"||p==="facebook"?" â „â †â –â ¶â ·â ¿":"  â–‘â–’â–“â–ˆ":r==="unicode-box"?o="  â–‘â–’â–“â–ˆ":r==="ascii"&&(o=" .'`^\",:;Il!i><~+_-?][}{1)(|\\/tfjrxnuvczMW&8%B@$");const h=Math.min(o.length-1,Math.floor(T/255*o.length));let a=o[h];a===" "&&(p==="instagram"||p==="youtube")&&(a="Â "),d+=a}else if(i){let r=f[0],o=1/0;for(let h=0;h<f.length;h++){const a=f[h],C=O({r:u,g:M,b:x},{r:a.r,g:a.g,b:a.b});C<o&&(o=C,r=a)}d+=r.char}else{let r=f[0],o=1/0;for(let h=0;h<f.length;h++){const a=f[h],C=O({r:u,g:M,b:x},{r:a.r,g:a.g,b:a.b});C<o&&(o=C,r=a)}z.push({char:r.char,x:Math.round(I),y:Math.round(w),color:`rgb(${Math.round(u)}, ${Math.round(M)}, ${Math.round(x)})`})}}else(l||i)&&(d+=p==="instagram"||p==="youtube"?"Â ":" ");W++}(i||l)&&(N+=d+`
`),(n%H===0||n===_-1)&&(self.postMessage({type:"PROGRESS",progress:Math.round(W/F*100)}),await new Promise(y=>setTimeout(y,0)))}if(b==="image"){if(g.watermark){const d="Made with Photo to Emoji Studio".split(""),w=D||10;d.forEach((y,I)=>{z.push({char:y,x:s-(d.length-I)*(w*.8),y:t-w,color:"rgba(128, 128, 128, 0.5)"})})}self.postMessage({type:"RESULT",result:z})}else{let n=N;g.watermark&&(n+=`

Generated by Photo to Emoji Studio`),self.postMessage({type:"TEXT_RESULT",text:n})}}self.onmessage=e=>{const{type:s,payload:t}=e.data;switch(s){case"INIT":G();break;case"PROCESS":U(t.imageData,t.width,t.height,t.settings,t.mode);break;case"CANCEL":j=!0;break}}})();
